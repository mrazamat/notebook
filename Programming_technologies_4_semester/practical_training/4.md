# Загрузка текстов в базу данных

**Предмет:** Технологии программирования  
**Специальность:** Компьютерная лингвистика  




## Содержание

1. [Введение](#введение)
2. [Основные понятия](#основные-понятия)
3. [Подготовка данных](#подготовка-данных)
4. [Методы загрузки текстов](#методы-загрузки-текстов)
5. [Работа с различными СУБД](#работа-с-различными-субд)
6. [Практические упражнения](#практические-упражнения)
7. [Контрольные вопросы](#контрольные-вопросы)



## Введение

Загрузка текстовых данных в базу данных — это фундаментальный процесс в разработке информационных систем, особенно важный для лингвистических приложений. В компьютерной лингвистике часто требуется работать с большими объемами текстовых данных: корпусами текстов, документами, лексиконами.

**Зачем нужна загрузка текстов в БД:**
- Организованное хранение текстовых данных
- Быстрый поиск и индексация информации
- Обеспечение целостности данных
- Возможность обработки больших объемов текстов
- Удобный доступ для лингвистического анализа



## Основные понятия

### База данных (БД)

Структурированное хранилище данных, позволяющее эффективно сохранять, извлекать и обновлять информацию.

### СУБД (Система управления базами данных)

Программное обеспечение для управления базами данных. Примеры: SQLite, PostgreSQL, MySQL, MongoDB.

### Таблица и схема

**Таблица** — основная структура реляционной БД, состоящая из строк (записей) и столбцов (полей).

**Схема** — описание структуры данных, включающее названия полей, их типы и ограничения.

Пример схемы для хранения текстов:

```
Таблица "texts"
├── id (INTEGER, PRIMARY KEY)
├── title (VARCHAR)
├── content (TEXT)
├── date_added (DATE)
└── language (VARCHAR)
```

### Типы данных для текстов

- `VARCHAR(n)` — строка фиксированной длины
- `TEXT` — текст произвольной длины
- `LONGTEXT` — очень большие тексты
- `CLOB` — большие объекты текста



## Подготовка данных

### Этап 1: Выбор источника данных

Текстовые данные могут поступать из:
- Текстовых файлов (.txt)
- Документов (.pdf, .docx)
- Веб-страниц
- Интернет-API
- Датчиков и логов

### Этап 2: Очистка и нормализация

Перед загрузкой необходимо:
- Удалить или кодировать специальные символы
- Привести кодировку к единому формату (UTF-8)
- Убрать лишние пробелы и переносы строк
- Проверить полноту данных

Пример очистки текста:

```python
text_clean = text.strip()  # Удалить пробелы в начале/конце
text_clean = text_clean.replace('\n', ' ')  # Заменить переносы
text_clean = ' '.join(text_clean.split())  # Удалить множественные пробелы
```

### Этап 3: Проверка данных

- Проверка размера текстов
- Проверка кодировки символов
- Валидация формата
- Проверка на дубликаты



## Методы загрузки текстов

### Метод 1: Прямая вставка через SQL

Самый простой способ для небольших объемов данных.

```sql
INSERT INTO texts (title, content, date_added, language)
VALUES ('Мой текст', 'Содержание текста...', '2024-02-27', 'русский');
```

**Преимущества:** Простота, прямое управление  
**Недостатки:** Медленно для больших объемов, требует ручного форматирования

### Метод 2: Пакетная загрузка (Batch Insert)

Загрузка нескольких записей за раз.

```sql
INSERT INTO тексты (название, содержание, язык) VALUES
('Текст 1', 'Содержание...', 'русский'),
('Текст 2', 'Содержание...', 'русский'),
('Текст 3', 'Содержание...', 'русский');
```

**Преимущества:** Быстрее чем одиночные вставки  
**Недостатки:** Все равно медленнее чем специализированные методы

### Метод 3: Загрузка из файла

Использование встроенных команд СУБД для импорта файлов.

**MySQL:**
```sql
LOAD DATA LOCAL INFILE '/путь/к/файлу.csv'
INTO TABLE texts
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
(title, content, language);
```

**PostgreSQL:**
```sql
COPY texts (title, content, language)
FROM '/путь/к/файлу.csv'
WITH (FORMAT csv, DELIMITER ',');
```

**Преимущества:** Самый быстрый способ для больших объемов  
**Недостатки:** Требует подготовленного файла, ограничения на формат

### Метод 4: Программная загрузка через язык программирования

Использование Python, Java, C# и других языков с драйверами БД.

**Пример на Python с SQLite:**

```python
import sqlite3

# Подключение к БД
связь = sqlite3.connect('linguistics.db')
курсор = связь.cursor()

# Создание таблицы
курсор.execute('''
    CREATE TABLE IF NOT EXISTS texts (
        id INTEGER PRIMARY KEY,
        title VARCHAR(255),
        content TEXT,
        language VARCHAR(255)
    )
''')

# Загрузка одного текста
курсор.execute(
    'INSERT INTO texts (title, content, language) VALUES (?, ?, ?)',
    ('Пример', 'Это пример текста', 'русский')
)

# Сохранение изменений
связь.commit()
связь.close()
```

**Преимущества:** Гибкость, интеграция с приложением, обработка ошибок  
**Недостатки:** Медленнее нативных методов СУБД



## Работа с различными СУБД

### SQLite

Легковесная встроенная БД, идеальна для учебных проектов и небольших приложений.

```python
import sqlite3

# Простое подключение и загрузка
связь = sqlite3.connect(':memory:')  # БД в памяти
курсор = связь.cursor()

курсор.execute('''
    CREATE TABLE texts (
        id INTEGER PRIMARY KEY,
        content TEXT
    )
''')

курсор.execute('INSERT INTO texts VALUES (1, ?)', ('Текст....',))
связь.commit()
```

### PostgreSQL

Мощная открытая СУБД с отличной поддержкой текстовых данных.

```python
import psycopg2

связь = psycopg2.connect(
    host="localhost",
    database="linguistics",
    user="пользователь",
    password="пароль"
)

курсор = связь.cursor()
курсор.execute('''
    INSERT INTO texts (title, content)
    VALUES (%s, %s)
''', ('Название', 'Содержание'))

связь.commit()
```

### MongoDB

Документо-ориентированная БД, подходит для неструктурированных текстовых данных.

```python
from pymongo import MongoClient

клиент = MongoClient('mongodb://localhost:27017/')
бд = клиент['linguistics']
коллекция = бд['texts']

# Вставка документа
коллекция.insert_one({
    'title': 'Мой текст',
    'content': 'Содержание текста...',
    'language': 'русский'
})
```



## Практические упражнения

### Упражнение 1: Создание схемы БД

**Задача:** Создайте таблицу для хранения текстов с лингвистической информацией.

**Требования:**
- Поля: id, текст, язык, количество_слов, дата_загрузки
- id — первичный ключ
- текст — может быть очень большим
- язык — ограничение на допустимые значения

### Упражнение 2: Загрузка текстов из файла

**Задача:** Загрузите 5 текстов из текстового файла в БД.

**Этапы:**
1. Создайте файл `тексты.txt` с 5 текстами, разделенными пустой строкой
2. Напишите программу на Python для чтения и загрузки
3. Проверьте, что все тексты загружены

### Упражнение 3: Пакетная вставка и проверка

**Задача:** Загрузите список текстов пакетным методом и проверьте результат.


### Упражнение 4: Загрузка с обработкой ошибок

**Задача:** Реализуйте загрузку с обработкой исключений и логированием.



## Контрольные вопросы

### Базовый уровень

1. Что такое база данных и зачем она нужна при работе с текстами?

2. Назовите три типа данных, подходящих для хранения текстов в БД.

3. Какой этап подготовки данных предшествует загрузке текстов в БД?

4. В чем различие между SQL командой `INSERT` и `INSERT ... SELECT`?

5. Какой метод загрузки лучше всего использовать для загрузки одного небольшого текста?

### Средний уровень

6. Объясните различие между методом `execute()` и `executemany()` в Python.

7. Какие преимущества и недостатки имеет загрузка текстов из файла по сравнению с программной вставкой?

8. Напишите SQL запрос для создания таблицы с полями: id, название, текст, язык, дата.

9. Что должно быть включено в процесс нормализации текстовых данных?

10. Почему при работе с большими текстами лучше использовать тип `LONGTEXT` вместо `VARCHAR`?

### Продвинутый уровень

11. Разработайте схему БД для хранения текстов с лингвистической разметкой (морфология, синтаксис).

12. Как бы вы реализовали загрузку текстов с одновременным подсчетом статистики (количество слов, предложений)?

13. Какие стратегии обработки ошибок и сбоев вы бы применили при массовой загрузке миллионов текстов?

14. Объясните, почему документо-ориентированные БД (как MongoDB) могут быть удобны для хранения неструктурированных лингвистических текстов.

15. Как обеспечить целостность данных при параллельной загрузке текстов несколькими процессами?



## Заключение

Загрузка текстов в базу данных — это необходимый навык для специалистов в области компьютерной лингвистики. Выбор оптимального метода загрузки зависит от объема данных, требуемой скорости и структуры текстов. Правильная организация этого процесса обеспечивает эффективное хранение и обработку лингвистических данных.

**Ключевые моменты:**
- Подготовка и очистка данных — обязательный этап
- Для небольших объемов подходят простые SQL вставки
- Для больших объемов используйте специализированные методы загрузки
- Всегда обрабатывайте ошибки и логируйте процесс
- Выбирайте СУБД в зависимости от характера данных

