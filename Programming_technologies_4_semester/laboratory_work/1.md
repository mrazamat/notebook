# Лабораторная работа №1
## Лаборатория SQL: создание текстовой базы данных

**Предмет:** Технологии программирования  
**Специальность:** Компьютерная лингвистика  

## Цель работы
Изучить основы SQL и научиться создавать реляционную базу данных для хранения и анализа текстовых данных с применением методов компьютерной лингвистики.


## Теоретическая часть
### Что такое SQL?
**SQL (Structured Query Language)** — язык структурированных запросов для работы с реляционными базами данных. В компьютерной лингвистике БД используются для хранения корпусов текстов, словарей, морфологических разборов и результатов анализа.
### Основные команды SQL

- `CREATE DATABASE` — создание базы данных
- `CREATE TABLE` — создание таблицы
- `INSERT INTO` — вставка данных
- `SELECT` — выборка данных
- `UPDATE` — обновление данных
- `DELETE` — удаление данных
- `JOIN` — объединение таблиц
- `WHERE` — условие фильтрации
- `GROUP BY` — группировка данных

### Типы данных

- `INT` — целое число
- `VARCHAR(n)` — строка переменной длины (до n символов)
- `TEXT` — текст произвольной длины
- `DATE` — дата
- `TIMESTAMP` — дата и время
- `DECIMAL` — десятичное число



## Задание

Создать базу данных для хранения текстового корпуса с возможностью лингвистического анализа.

### Структура БД должна включать:

1. Таблицу документов (тексты)
2. Таблицу слов (словарь)
3. Таблицу вхождений слов в документы
4. Таблицу морфологических характеристик

### Схема базы данных

```
documents (документы)
├── doc_id (PK)
├── title
├── author
├── text
├── language
├── genre
├── publication_date
├── word_count
└── created_at

lexicon (лексикон)
├── word_id (PK)
├── word_form
├── lemma
├── frequency
└── first_occurrence

morphology (морфология)
├── morph_id (PK)
├── word_id (FK)
├── pos
├── case_form
├── gender
├── number
└── tense

word_occurrences (вхождения)
├── occurrence_id (PK)
├── doc_id (FK)
├── word_id (FK)
├── position
└── sentence_num
```



## Ход работы

### Шаг 1: Создание базы данных

```sql
CREATE DATABASE text_corpus_db;
USE text_corpus_db;
```

**Объяснение:** Эта команда создает новую базу данных с именем `text_corpus_db` и делает её активной для последующих операций.



### Шаг 2: Создание таблиц

#### Таблица документов

```sql
CREATE TABLE documents (
    doc_id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    author VARCHAR(100),
    text TEXT NOT NULL,
    language VARCHAR(10) DEFAULT 'ru',
    genre VARCHAR(50),
    publication_date DATE,
    word_count INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Поля:**
- `doc_id` — уникальный идентификатор документа
- `title` — название документа (обязательное поле)
- `author` — автор документа
- `text` — текст документа (обязательное поле)
- `language` — язык документа (по умолчанию русский)
- `genre` — жанр произведения
- `publication_date` — дата публикации
- `word_count` — количество слов
- `created_at` — дата добавления в БД

#### Таблица слов (лексикон)

```sql
CREATE TABLE lexicon (
    word_id INT PRIMARY KEY AUTO_INCREMENT,
    word_form VARCHAR(100) NOT NULL UNIQUE,
    lemma VARCHAR(100),
    frequency INT DEFAULT 1,
    first_occurrence TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Поля:**
- `word_id` — уникальный идентификатор слова
- `word_form` — словоформа (уникальная)
- `lemma` — лемма (начальная форма)
- `frequency` — частота встречаемости
- `first_occurrence` — первое появление в корпусе

#### Таблица морфологических характеристик

```sql
CREATE TABLE morphology (
    morph_id INT PRIMARY KEY AUTO_INCREMENT,
    word_id INT,
    pos VARCHAR(20), -- часть речи
    case_form VARCHAR(20), -- падеж
    gender VARCHAR(20), -- род
    number VARCHAR(20), -- число
    tense VARCHAR(20), -- время
    FOREIGN KEY (word_id) REFERENCES lexicon(word_id)
);
```

**Поля:**
- `morph_id` — уникальный идентификатор записи
- `word_id` — ссылка на слово из лексикона
- `pos` — часть речи (существительное, глагол, прилагательное и т.д.)
- `case_form` — падеж
- `gender` — род
- `number` — число (единственное/множественное)
- `tense` — время (для глаголов)

#### Таблица вхождений

```sql
CREATE TABLE word_occurrences (
    occurrence_id INT PRIMARY KEY AUTO_INCREMENT,
    doc_id INT,
    word_id INT,
    position INT, -- позиция слова в документе
    sentence_num INT, -- номер предложения
    FOREIGN KEY (doc_id) REFERENCES documents(doc_id),
    FOREIGN KEY (word_id) REFERENCES lexicon(word_id)
);
```

**Поля:**
- `occurrence_id` — уникальный идентификатор вхождения
- `doc_id` — ссылка на документ
- `word_id` — ссылка на слово
- `position` — позиция слова в документе
- `sentence_num` — номер предложения



### Шаг 3: Заполнение таблиц тестовыми данными

#### Добавление документов

```sql
INSERT INTO documents (title, author, text, genre, publication_date, word_count)
VALUES 
('Евгений Онегин', 'А.С. Пушкин', 
 'Мой дядя самых честных правил, когда не в шутку занемог, он уважать себя заставил и лучше выдумать не мог.',
 'поэзия', '1833-03-01', 18),
 
('Война и мир', 'Л.Н. Толстой',
 'Все счастливые семьи похожи друг на друга, каждая несчастливая семья несчастлива по-своему.',
 'роман', '1869-01-01', 14),
 
('Мастер и Маргарита', 'М.А. Булгаков',
 'Однажды весною, в час небывало жаркого заката, в Москве, на Патриарших прудах, появились два гражданина.',
 'роман', '1967-01-01', 16);
```

#### Добавление слов в лексикон

```sql
INSERT INTO lexicon (word_form, lemma, frequency)
VALUES 
('дядя', 'дядя', 1),
('самых', 'самый', 1),
('честных', 'честный', 1),
('правил', 'правило', 1),
('семьи', 'семья', 2),
('счастливые', 'счастливый', 1),
('несчастливая', 'несчастливый', 1),
('весною', 'весна', 1),
('жаркого', 'жаркий', 1),
('прудах', 'пруд', 1);
```

#### Добавление морфологических характеристик

```sql
INSERT INTO morphology (word_id, pos, case_form, gender, number)
VALUES 
(1, 'существительное', 'именительный', 'мужской', 'единственное'),
(2, 'прилагательное', 'родительный', NULL, 'множественное'),
(3, 'прилагательное', 'родительный', NULL, 'множественное'),
(4, 'существительное', 'родительный', 'средний', 'множественное'),
(5, 'существительное', 'именительный', 'женский', 'множественное'),
(6, 'прилагательное', 'именительный', NULL, 'множественное'),
(7, 'прилагательное', 'именительный', 'женский', 'единственное'),
(8, 'существительное', 'творительный', 'женский', 'единственное'),
(9, 'прилагательное', 'родительный', 'мужской', 'единственное'),
(10, 'существительное', 'предложный', 'мужской', 'множественное');
```

#### Добавление вхождений

```sql
INSERT INTO word_occurrences (doc_id, word_id, position, sentence_num)
VALUES 
-- Евгений Онегин
(1, 1, 2, 1),
(1, 2, 3, 1),
(1, 3, 4, 1),
(1, 4, 5, 1),

-- Война и мир
(2, 5, 3, 1),
(2, 6, 2, 1),
(2, 7, 8, 1),
(2, 5, 9, 1),

-- Мастер и Маргарита
(3, 8, 2, 1),
(3, 9, 7, 1),
(3, 10, 11, 1);
```



### Шаг 4: Выполнение аналитических запросов

#### Запрос 1: Найти все документы определенного автора

```sql
SELECT * FROM documents
WHERE author LIKE '%Пушкин%';
```

**Ожидаемый результат:** Документ "Евгений Онегин"

#### Запрос 2: Подсчитать частотность слов

```sql
SELECT 
    word_form, 
    COUNT(*) as frequency
FROM word_occurrences
JOIN lexicon ON word_occurrences.word_id = lexicon.word_id
GROUP BY word_form
ORDER BY frequency DESC;
```

**Назначение:** Создание частотного словаря корпуса.

#### Запрос 3: Найти все существительные в документе

```sql
SELECT DISTINCT 
    l.word_form, 
    m.pos, 
    m.gender, 
    m.number,
    m.case_form
FROM word_occurrences wo
JOIN lexicon l ON wo.word_id = l.word_id
JOIN morphology m ON l.word_id = m.word_id
WHERE wo.doc_id = 1 AND m.pos = 'существительное';
```

**Назначение:** Морфологический анализ текста.

#### Запрос 4: Статистика по документам

```sql
SELECT 
    d.title,
    d.author,
    d.word_count,
    COUNT(DISTINCT wo.word_id) as unique_words,
    ROUND(d.word_count / COUNT(DISTINCT wo.word_id), 2) as lexical_diversity
FROM documents d
LEFT JOIN word_occurrences wo ON d.doc_id = wo.doc_id
GROUP BY d.doc_id;
```

**Назначение:** Вычисление лексического разнообразия текстов.

#### Запрос 5: Поиск слов с определенной леммой

```sql
SELECT 
    word_form, 
    lemma, 
    frequency
FROM lexicon
WHERE lemma = 'семья'
ORDER BY frequency DESC;
```

**Назначение:** Поиск всех словоформ одного слова.

#### Запрос 6: Найти документы по жанру

```sql
SELECT 
    title, 
    author, 
    genre, 
    publication_date
FROM documents
WHERE genre = 'роман'
ORDER BY publication_date;
```

#### Запрос 7: Слова с максимальной частотой

```sql
SELECT 
    word_form, 
    lemma,
    COUNT(*) as total_occurrences
FROM word_occurrences wo
JOIN lexicon l ON wo.word_id = l.word_id
GROUP BY wo.word_id
ORDER BY total_occurrences DESC
LIMIT 10;
```

#### Запрос 8: Распределение частей речи в документе

```sql
SELECT 
    m.pos,
    COUNT(*) as count
FROM word_occurrences wo
JOIN morphology m ON wo.word_id = m.word_id
WHERE wo.doc_id = 1
GROUP BY m.pos
ORDER BY count DESC;
```


## Контрольные вопросы

1. Что такое первичный ключ (PRIMARY KEY) и зачем он нужен?
2. Чем отличается `VARCHAR` от `TEXT`?
3. Для чего используются внешние ключи (FOREIGN KEY)?
4. Как работает оператор `JOIN`? Какие типы `JOIN` вы знаете?
5. В чем преимущество использования нормализованной БД для хранения текстов?
6. Какие индексы следует создать для ускорения лингвистического поиска?
7. Что такое лексическое разнообразие и как его вычислить?



## Практические задачи

### Задача 1: Расширение функциональности
Добавьте в базу данных:
- Таблицу предложений с их характеристиками
- Таблицу синтаксических связей между словами
- Таблицу именованных сущностей (NER)

### Задача 2: Аналитические запросы
Напишите запросы для:
- Нахождения самых длинных предложений
- Вычисления средней длины предложения по авторам
- Поиска слов, встречающихся только у одного автора





## Требования к отчету

Отчет должен содержать:

1. **Титульный лист**
   - Название работы
   - ФИО студента
   - Группа
   - Дата выполнения

2. **Цель работы**

3. **Теоретическая часть**
   - Краткое описание используемых технологий
   - Схема базы данных (диаграмма связей)

4. **Практическая часть**
   - SQL-скрипты создания таблиц
   - Примеры запросов с результатами выполнения
   - Скриншоты работы в СУБД

5. **Анализ результатов**
   - Интерпретация полученных данных
   - Сравнение характеристик разных текстов

6. **Выводы**
   - Что было изучено
   - Какие навыки приобретены
   - Возможные применения

7. **Список использованных источников**



## Критерии оценки

| Критерий                          | Баллы |
|-----------------------------------|-------|
| Корректность структуры БД         | 30%   |
| Правильность SQL-запросов         | 30%   |
| Полнота выполнения заданий        | 20%   |
| Качество оформления отчета        | 10%   |
| Выполнение дополнительных заданий | 10%   |

### Шкала оценивания:
- 90-100% — Отлично
- 75-89% — Хорошо
- 60-74% — Удовлетворительно
- < 60% — Неудовлетворительно




### Приложение: Примеры морфологических категорий

**Части речи (POS):**
- существительное
- прилагательное
- глагол
- наречие
- местоимение
- предлог
- союз
- частица
- междометие

**Падежи:**
- именительный
- родительный
- дательный
- винительный
- творительный
- предложный

**Род:**
- мужской
- женский
- средний

**Число:**
- единственное
- множественное

**Время (для глаголов):**
- настоящее
- прошедшее
- будущее



  
**Форма сдачи:** отчет в формате PDF + файл с SQL-скриптами (.sql)
