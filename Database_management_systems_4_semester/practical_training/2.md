# Выбор данных с помощью оператора SELECT

**Предмет:** Система управления базами данных  
**Специальность:** Компьютерная лингвистика  

---

## Введение

Оператор `SELECT` — основной инструмент для извлечения данных из реляционных баз данных. В контексте компьютерной лингвистики он используется для работы с корпусами текстов, словарями, морфологическими базами и другими лингвистическими данными.

---

## 1. Базовый синтаксис SELECT

### 1.1 Простейший запрос

```sql
SELECT столбец1, столбец2, ...
FROM имя_таблицы;
```

**Пример:**
```sql
SELECT word, pos
FROM dictionary;
```

### 1.2 Выбор всех столбцов

```sql
SELECT *
FROM имя_таблицы;
```

**Пример:**
```sql
SELECT *
FROM corpus_texts;
```

> **Примечание:** Использование `*` удобно для исследования данных, но в production-коде лучше явно указывать нужные столбцы.

---

## 2. Фильтрация данных — WHERE

### 2.1 Базовое использование WHERE

```sql
SELECT столбцы
FROM таблица
WHERE условие;
```

**Пример для лингвистики:**
```sql
SELECT word, frequency
FROM word_frequency
WHERE frequency > 1000;
```

### 2.2 Операторы сравнения

| Оператор | Описание |
|----------|----------|
| `=` | Равно |
| `<>` или `!=` | Не равно |
| `>` | Больше |
| `<` | Меньше |
| `>=` | Больше или равно |
| `<=` | Меньше или равно |

**Пример:**
```sql
SELECT lemma, word_form
FROM morphology
WHERE pos = 'NOUN';
```

### 2.3 Логические операторы

**AND:**
```sql
SELECT word, pos, case_form
FROM inflections
WHERE pos = 'NOUN' AND case_form = 'genitive';
```

**OR:**
```sql
SELECT text_id, sentence
FROM sentences
WHERE language = 'ru' OR language = 'en';
```

**NOT:**
```sql
SELECT word
FROM stopwords
WHERE NOT language = 'ru';
```

### 2.4 Оператор IN

```sql
SELECT word, pos
FROM dictionary
WHERE pos IN ('NOUN', 'VERB', 'ADJ');
```

### 2.5 Оператор BETWEEN

```sql
SELECT word, frequency
FROM word_stats
WHERE frequency BETWEEN 100 AND 500;
```

### 2.6 Оператор LIKE (поиск по шаблону)

Специальные символы:
- `%` — любая последовательность символов
- `_` — один любой символ

**Примеры:**
```sql
-- Слова, начинающиеся с "лингв"
SELECT word
FROM dictionary
WHERE word LIKE 'лингв%';

-- Слова из 5 букв, начинающиеся с "к"
SELECT word
FROM dictionary
WHERE word LIKE 'к____';

-- Слова, содержащие "морф"
SELECT word
FROM dictionary
WHERE word LIKE '%морф%';
```

### 2.7 NULL значения

```sql
-- Найти записи без перевода
SELECT word_id, word
FROM translations
WHERE translation IS NULL;

-- Найти записи с переводом
SELECT word_id, word
FROM translations
WHERE translation IS NOT NULL;
```

---

## 3. Сортировка — ORDER BY

### 3.1 Базовый синтаксис

```sql
SELECT столбцы
FROM таблица
ORDER BY столбец [ASC|DESC];
```

- `ASC` — по возрастанию (по умолчанию)
- `DESC` — по убыванию

**Примеры:**
```sql
-- По алфавиту
SELECT word, frequency
FROM word_frequency
ORDER BY word ASC;

-- По частотности (от частых к редким)
SELECT word, frequency
FROM word_frequency
ORDER BY frequency DESC;
```

### 3.2 Сортировка по нескольким столбцам

```sql
SELECT word, pos, frequency
FROM dictionary
ORDER BY pos ASC, frequency DESC;
```

---

## 4. Ограничение результатов — LIMIT

### 4.1 Базовое использование

```sql
SELECT word, frequency
FROM word_frequency
ORDER BY frequency DESC
LIMIT 10;
```

### 4.2 LIMIT с OFFSET (пропуск строк)

```sql
-- Пропустить первые 10 записей, взять следующие 10
SELECT word, frequency
FROM word_frequency
ORDER BY frequency DESC
LIMIT 10 OFFSET 10;
```

---

## 5. Устранение дубликатов — DISTINCT

```sql
SELECT DISTINCT pos
FROM dictionary;
```

**Пример:**
```sql
-- Уникальные языки в корпусе
SELECT DISTINCT language
FROM corpus_metadata;
```

---

## 6. Агрегатные функции

### 6.1 Основные функции

| Функция | Описание |
|---------|----------|
| `COUNT()` | Подсчет строк |
| `SUM()` | Сумма значений |
| `AVG()` | Среднее значение |
| `MIN()` | Минимальное значение |
| `MAX()` | Максимальное значение |

**Примеры:**
```sql
-- Общее количество слов
SELECT COUNT(*) AS total_words
FROM dictionary;

-- Средняя частотность
SELECT AVG(frequency) AS avg_frequency
FROM word_frequency;

-- Самая высокая частотность
SELECT MAX(frequency) AS max_frequency
FROM word_frequency;
```

### 6.2 COUNT с условием

```sql
-- Количество существительных
SELECT COUNT(*) AS noun_count
FROM dictionary
WHERE pos = 'NOUN';

-- Количество уникальных частей речи
SELECT COUNT(DISTINCT pos) AS pos_types
FROM dictionary;
```

---

## 7. Группировка — GROUP BY

### 7.1 Базовое использование

```sql
SELECT pos, COUNT(*) AS count
FROM dictionary
GROUP BY pos;
```

**Результат:**
```
pos    | count
-------|------
NOUN   | 15420
VERB   | 8930
ADJ    | 7210
...
```

### 7.2 GROUP BY с несколькими столбцами

```sql
SELECT language, pos, COUNT(*) AS count
FROM multilingual_dict
GROUP BY language, pos
ORDER BY language, count DESC;
```

### 7.3 HAVING (фильтрация после группировки)

```sql
-- Части речи с более чем 5000 слов
SELECT pos, COUNT(*) AS count
FROM dictionary
GROUP BY pos
HAVING COUNT(*) > 5000
ORDER BY count DESC;
```

> **Различие WHERE и HAVING:**
> - `WHERE` фильтрует строки ДО группировки
> - `HAVING` фильтрует группы ПОСЛЕ группировки

---

## 8. Псевдонимы (Aliases)

### 8.1 Псевдонимы столбцов

```sql
SELECT 
    word AS слово,
    pos AS часть_речи,
    frequency AS частота
FROM dictionary;
```

### 8.2 Псевдонимы таблиц

```sql
SELECT w.word, w.frequency
FROM word_frequency AS w
WHERE w.frequency > 100;
```

---

## 9. Практические примеры для компьютерной лингвистики

### Пример 1: Анализ корпуса текстов

```sql
-- Найти все предложения на русском языке длиной более 10 слов
SELECT sentence_id, sentence, word_count
FROM sentences
WHERE language = 'ru' AND word_count > 10
ORDER BY word_count DESC
LIMIT 20;
```

### Пример 2: Морфологический анализ

```sql
-- Статистика по падежам существительных
SELECT case_form, COUNT(*) AS occurrences
FROM morphology
WHERE pos = 'NOUN'
GROUP BY case_form
ORDER BY occurrences DESC;
```

### Пример 3: Работа с n-граммами

```sql
-- Самые частотные биграммы
SELECT bigram, frequency
FROM bigrams
WHERE frequency >= 50
ORDER BY frequency DESC
LIMIT 30;
```

### Пример 4: Анализ словаря

```sql
-- Найти слова с конкретным окончанием (суффиксом)
SELECT word, pos
FROM dictionary
WHERE word LIKE '%ость'
ORDER BY word;
```

---

## Практические упражнения

### Упражнение 1: Базовые запросы

Имеется таблица `words`:

| word_id | word | pos | frequency | length |
|---------|------|-----|-----------|--------|
| 1 | язык | NOUN | 2500 | 4 |
| 2 | лингвистика | NOUN | 890 | 11 |
| 3 | анализировать | VERB | 1200 | 13 |
| 4 | синтаксический | ADJ | 450 | 14 |
| 5 | корпус | NOUN | 670 | 6 |

**Задания:**

1. Выберите все слова длиной более 10 символов
2. Найдите все глаголы с частотностью выше 1000
3. Получите список всех частей речи без повторений
4. Выведите 3 самых частотных слова

### Упражнение 2: Фильтрация и сортировка

Таблица `morphology`:

| form_id | lemma | word_form | pos | case_form | number |
|---------|-------|-----------|-----|-----------|--------|
| 1 | слово | слова | NOUN | genitive | singular |
| 2 | слово | словам | NOUN | dative | plural |
| 3 | читать | читал | VERB | NULL | NULL |
| 4 | синий | синему | ADJ | dative | singular |

**Задания:**

1. Найдите все формы существительных в родительном падеже
2. Выберите все словоформы леммы "слово"
3. Получите список всех лемм глаголов
4. Найдите формы прилагательных в дательном падеже единственного числа

### Упражнение 3: Агрегация и группировка

Таблица `corpus_stats`:

| text_id | author | genre | word_count | year |
|---------|--------|-------|------------|------|
| 1 | Пушкин | poetry | 1500 | 1825 |
| 2 | Толстой | prose | 12000 | 1869 |
| 3 | Пушкин | prose | 3500 | 1830 |
| 4 | Чехов | prose | 4500 | 1895 |
| 5 | Пушкин | poetry | 2000 | 1820 |

**Задания:**

1. Подсчитайте общее количество текстов в корпусе
2. Найдите среднее количество слов в тексте
3. Определите количество текстов по каждому автору
4. Найдите авторов, у которых более 2 текстов в корпусе
5. Посчитайте общее количество слов по жанрам

### Упражнение 4: Комплексные запросы

Таблица `translations`:

| word_id | word_ru | word_en | pos | context |
|---------|---------|---------|-----|---------|
| 1 | язык | language | NOUN | лингвистика |
| 2 | корпус | corpus | NOUN | лингвистика |
| 3 | быстрый | fast | ADJ | NULL |
| 4 | анализ | analysis | NOUN | лингвистика |
| 5 | медленный | slow | ADJ | NULL |

**Задания:**

1. Найдите все термины (контекст = 'лингвистика') и отсортируйте по русскому слову
2. Выберите все переводы существительных
3. Найдите слова, у которых нет контекста
4. Получите количество слов по частям речи только для лингвистических терминов

---

## Контрольные вопросы

### Теоретические вопросы

1. Какая разница между командами `SELECT` и `SELECT DISTINCT`?
2. Объясните различие между операторами `WHERE` и `HAVING`
3. Зачем нужен оператор `LIMIT` и как он используется с `OFFSET`?
4. Какие агрегатные функции вы знаете? Приведите примеры их использования
5. В каком порядке выполняются части SQL-запроса (FROM, WHERE, SELECT, ORDER BY, LIMIT)?
6. Чем отличается `NULL` от пустой строки?
7. Можно ли использовать агрегатные функции в `WHERE`? Почему?
8. Как работает оператор `LIKE`? Какие спецсимволы используются?

### Практические вопросы

9. Напишите запрос для поиска всех слов, начинающихся на "мета" и заканчивающихся на "ия"
10. Как вывести топ-10 самых редких слов в словаре?
11. Составьте запрос для подсчета среднего количества слов в предложениях по каждому языку
12. Как найти все записи, где значение частоты находится между 100 и 500 или больше 1000?
13. Напишите запрос для вывода списка авторов и количества их текстов, только для авторов с более чем 5 текстами
14. Как выбрать второй десяток записей (с 11 по 20) из отсортированного списка?
15. Составьте запрос для поиска всех 4-буквенных слов, начинающихся с гласной

---

## Дополнительные ресурсы

**Для практики:**
- SQLite — легковесная СУБД для экспериментов
- PostgreSQL — мощная СУБД с поддержкой полнотекстового поиска
- MySQL — популярная СУБД

**Онлайн-ресурсы:**
- SQLBolt, LeetCode Database
- Документация: официальные документации СУБД
- Датасеты: NLTK корпуса, Universal Dependencies

---

## Заключение

Оператор `SELECT` — фундаментальный инструмент для работы с данными в SQL. Для специалистов по компьютерной лингвистике владение SQL критически важно для:

- Работы с текстовыми корпусами
- Анализа частотных словарей
- Исследования морфологических баз
- Обработки параллельных текстов
- Статистического анализа языковых данных

---

